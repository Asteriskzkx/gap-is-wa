# แผนการทดสอบการสรุปผลการตรวจประเมินสวนยางพารา (Playwright E2E Testing)

**รวม 20 Test Cases (เฉพาะเคสที่ทำ E2E ด้วย Playwright ได้จริง) — ครอบคลุมเฉพาะหน้า Reports List**

> หน้าเป้าหมาย: `/auditor/reports` (ไฟล์ `src/app/auditor/reports/page.tsx`)
>
> หมายเหตุ:
>
> - หน้านี้ render คอมโพเนนต์ `InspectionReports` เป็นหลัก จึงอ้างอิง UI/ข้อความจาก `src/components/shared/InspectionReports.tsx` และ `src/components/shared/LocationFilters.tsx`
> - ตัดเคสที่เป็นหน้าถัดไป (Summary/Detail) และเคสที่ต้องตรวจ DB/พารามิเตอร์ backend/CSS/spacing ออก
> - กรณีต้องคุมข้อมูล (empty / มีข้อมูลเฉพาะจังหวัด) ให้ทำผ่าน seed data หรือ mock network ใน Playwright (`page.route`)

## รายการตรวจประเมิน (Reports List)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                              | ขั้นตอนการทดสอบ                                                              | ข้อมูลการทดสอบ              | ค่าคาดหวัง                                                                               |
| ------------- | --------------------------------------------- | ---------------------------------------------------------------------------- | --------------------------- | ---------------------------------------------------------------------------------------- |
| TC-001        | ไม่ได้ login แล้วเข้าหน้า Reports             | 1. ไม่ได้ login<br>2. เปิดหน้า `/auditor/reports`                            | ไม่มี session               | ระบบ redirect ไปหน้า `/`                                                                 |
| TC-002        | แสดงหัวข้อและคำอธิบาย                         | 1. Login เป็น Auditor<br>2. เปิดหน้า `/auditor/reports`                      | มี session                  | เห็นหัวข้อ “สรุปผลการตรวจประเมิน” และ subtitle “จัดการและสรุปผลการตรวจประเมินสวนยางพารา” |
| TC-003        | ค่าเริ่มต้นอยู่แท็บ “รอสรุปผล”                | 1. Login เป็น Auditor<br>2. เปิดหน้า `/auditor/reports`                      | มี session                  | ปุ่มแท็บ “รอสรุปผล” แสดงสถานะถูกเลือก (active) และตารางโหลดรายการของแท็บนี้              |
| TC-004        | แสดง loading ระหว่างดึงข้อมูล                 | 1. เปิดหน้า Reports List                                                     | API ตอบช้า                  | ตารางแสดงสถานะ loading และเมื่อโหลดเสร็จจะแสดงข้อมูล                                     |
| TC-005        | แสดงคอลัมน์ตารางครบถ้วน                       | 1. เปิดหน้า Reports List<br>2. ตรวจสอบหัวคอลัมน์                             | มีข้อมูล                    | มีคอลัมน์: “รหัสการตรวจ”, “เกษตรกร”, “สถานที่”, “วันที่ตรวจ”, “สถานะ”, “จัดการ”          |
| TC-006        | แสดงชื่อเกษตรกรเมื่อมีข้อมูล                  | 1. เปิดหน้า Reports List<br>2. ตรวจสอบคอลัมน์ “เกษตรกร” ของแถวที่มี farmer   | มีข้อมูล                    | แสดงรูปแบบ “คำนำหน้า+ชื่อ นามสกุล”                                                       |
| TC-007        | แสดง “ไม่มีข้อมูล” เมื่อไม่มี farmer          | 1. เปิดหน้า Reports List<br>2. ดูแถวที่ `rubberFarm.farmer` เป็น null        | มีข้อมูลบางแถว farmer=null  | คอลัมน์ “เกษตรกร” แสดง “ไม่มีข้อมูล”                                                     |
| TC-008        | แสดง “สถานที่” แบบต่อข้อความ และ fallback “-” | 1. เปิดหน้า Reports List<br>2. ตรวจสอบคอลัมน์ “สถานที่”                      | มีข้อมูลหลายรูปแบบ          | ถ้ามีข้อมูลบางส่วนให้ join ด้วยเว้นวรรค; ถ้าไม่มีทั้งหมดให้แสดง “-”                      |
| TC-009        | แสดงวันที่ตรวจรูปแบบไทย                       | 1. เปิดหน้า Reports List<br>2. ตรวจสอบคอลัมน์ “วันที่ตรวจ”                   | inspectionDateAndTime มีค่า | วันที่แสดงในรูปแบบไทย (th-TH) เช่น “1 ธ.ค. 2568”                                         |
| TC-010        | สลับแท็บเป็น “เสร็จสิ้น”                      | 1. คลิกแท็บ “เสร็จสิ้น”                                                      | มีข้อมูล completed          | ตารางเปลี่ยนเป็นรายการเสร็จสิ้น และ empty message ของแท็บนี้ถูกต้อง                      |
| TC-011        | สลับแท็บไป/กลับแล้ว pagination reset          | 1. ไปหน้าที่ 2 ของตาราง<br>2. สลับแท็บ “เสร็จสิ้น”<br>3. สลับกลับ “รอสรุปผล” | มีข้อมูลหลายหน้า            | ตารางกลับมาเริ่มที่หน้าแรก (page 1)                                                      |

## ตัวกรองพื้นที่ (จังหวัด/อำเภอ/ตำบล) + ค้นหา/ล้างค่า

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                              | ขั้นตอนการทดสอบ                                                 | ข้อมูลการทดสอบ      | ค่าคาดหวัง                                                                     |
| ------------- | --------------------------------------------- | --------------------------------------------------------------- | ------------------- | ------------------------------------------------------------------------------ |
| TC-012        | เริ่มต้น: อำเภอ disabled จนกว่าจะเลือกจังหวัด | 1. เปิดหน้า Reports List                                        | -                   | ช่อง “อำเภอ/เขต” disabled ก่อนเลือก “จังหวัด”                                  |
| TC-013        | เลือกจังหวัดแล้วอำเภอ enable และรีเซ็ตค่าเด็ก | 1. เลือก “จังหวัด”<br>2. สังเกต “อำเภอ/เขต” และ “ตำบล/แขวง”     | -                   | “อำเภอ/เขต” enable; “ตำบล/แขวง” disabled และค่าอำเภอ/ตำบลถูกรีเซ็ต             |
| TC-014        | เลือกอำเภอแล้วตำบล enable และรีเซ็ตตำบล       | 1. เลือก “จังหวัด”<br>2. เลือก “อำเภอ/เขต”                      | -                   | “ตำบล/แขวง” enable และค่าเดิมถูกรีเซ็ตเพื่อเลือกใหม่                           |
| TC-015        | ค้นหาด้วยพื้นที่ (จังหวัดอย่างเดียว)          | 1. เลือก “จังหวัด”<br>2. กด “ค้นหา”                             | มีข้อมูลหลายจังหวัด | รายการในตารางเปลี่ยนตามจังหวัดที่เลือก (ยืนยันจากชุดข้อมูล/จำนวนแถวที่เปลี่ยน) |
| TC-016        | ค้นหาด้วยพื้นที่ครบ 3 ระดับ                   | 1. เลือก “จังหวัด” + “อำเภอ/เขต” + “ตำบล/แขวง”<br>2. กด “ค้นหา” | มีข้อมูลรองรับ      | รายการในตารางเปลี่ยนตามพื้นที่ที่เลือก                                         |
| TC-017        | กด “ล้างค่า” รีเซ็ตตัวกรองทั้งหมด             | 1. เลือกพื้นที่บางส่วน<br>2. กด “ล้างค่า”                       | มีค่าตัวกรองอยู่    | ค่าจังหวัด/อำเภอ/ตำบลถูกล้าง และตารางกลับสภาพไม่กรอง                           |

## การโต้ตอบกับตาราง (Pagination / Sorting / Navigation)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                            | ขั้นตอนการทดสอบ                                                                                                               | ข้อมูลการทดสอบ                           | ค่าคาดหวัง                                                                                                           |
| ------------- | ------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| TC-018        | Pagination: เปลี่ยนจำนวนรายการต่อหน้า       | 1. เปลี่ยน rows เป็น 25 หรือ 50                                                                                               | มีข้อมูลมากพอ                            | ตารางแสดงจำนวนรายการต่อหน้าตามที่เลือก                                                                               |
| TC-019        | Pagination: เปลี่ยนหน้า                     | 1. ไปหน้าถัดไปจาก paginator                                                                                                   | มีข้อมูลหลายหน้า                         | ตารางแสดงรายการตามหน้าที่เลือก                                                                                       |
| TC-020        | Sorting: คลิกหัวคอลัมน์ “รหัสการตรวจ”       | 1. คลิกหัวคอลัมน์ “รหัสการตรวจ” 1 ครั้ง<br>2. คลิกอีกครั้ง                                                                    | มีข้อมูลหลายแถว                          | ลำดับรายการเปลี่ยนตามการ sort (ตรวจจากค่าบรรทัดบนสุด/ชุดข้อมูลที่เปลี่ยน)                                            |
| TC-021        | Sorting: คลิกหัวคอลัมน์ “วันที่ตรวจ”        | 1. คลิกหัวคอลัมน์ “วันที่ตรวจ” 1 ครั้ง<br>2. คลิกอีกครั้ง                                                                     | มีข้อมูลหลายวันที่                       | ลำดับรายการเปลี่ยนตามการ sort                                                                                        |
| TC-022        | ปุ่ม “จัดการ” ในแท็บรอสรุป: ไปหน้าสรุปผล    | 1. อยู่แท็บ “รอสรุปผล”<br>2. คลิกปุ่มในคอลัมน์ “จัดการ” ของรายการหนึ่ง                                                        | inspectionResult = “รอผลการตรวจประเมิน”  | Navigate ไป `/auditor/inspection-summary/{inspectionId}`                                                             |
| TC-023        | ปุ่ม “จัดการ” ในแท็บเสร็จสิ้น: ไปหน้าสรุปผล | 1. อยู่แท็บ “เสร็จสิ้น”<br>2. คลิกปุ่มในคอลัมน์ “จัดการ” ของรายการหนึ่ง                                                       | inspectionResult != “รอผลการตรวจประเมิน” | Navigate ไป `/auditor/inspection-summary/{inspectionId}`                                                             |
| TC-024        | Empty message แยกตามแท็บ                    | 1. ทำให้แท็บ “รอสรุปผล” ไม่มีข้อมูล<br>2. ตรวจ empty message<br>3. ทำให้แท็บ “เสร็จสิ้น” ไม่มีข้อมูล<br>4. ตรวจ empty message | results ว่าง                             | แท็บ “รอสรุปผล” แสดง “ไม่พบรายการตรวจประเมินที่รอสรุปผล”; แท็บ “เสร็จสิ้น” แสดง “ไม่พบรายการตรวจประเมินที่เสร็จสิ้น” |
