# แผนการทดสอบการลบบัญชีผู้ใช้ในระบบ

## การเข้าถึงฟังก์ชันลบผู้ใช้

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                              | ขั้นตอนการทดสอบ                                                                                                    | ข้อมูลการทดสอบ                        | ค่าคาดหวัง                                                              |
| ------------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------- | ----------------------------------------------------------------------- |
| TC-001        | แสดงเมนูลบผู้ใช้                              | 1. Login เป็น Admin<br>2. ไปหน้า "จัดการผู้ใช้"<br>3. คลิกปุ่ม "..." ที่แถวผู้ใช้                                  | มีผู้ใช้ในระบบ                        | แสดงเมนู popup มีตัวเลือก "Delete"                                      |
| TC-002        | เปิด Dialog ยืนยันการลบ                       | 1. Login เป็น Admin<br>2. ไปหน้า "จัดการผู้ใช้"<br>3. คลิกปุ่ม "..."<br>4. เลือก "Delete"                          | userId = 5                            | เปิด Dialog "ยืนยันการลบ" พร้อมแสดงชื่อผู้ใช้ที่จะลบ                    |
| TC-003        | แสดงชื่อผู้ใช้ใน Dialog                       | 1. เปิด Dialog ยืนยันการลบ                                                                                         | user.name = "สมชาย ใจดี"              | แสดงข้อความ "ต้องการลบผู้ใช้ชื่อ : สมชาย ใจดี ใช่ไหม?"                  |
| TC-004        | แสดง "-" เมื่อไม่มีชื่อผู้ใช้                 | 1. เปิด Dialog ยืนยันการลบผู้ใช้ที่ไม่มีชื่อ                                                                       | user.name = null                      | แสดงข้อความ "ต้องการลบผู้ใช้ชื่อ : - ใช่ไหม?"                           |

## การยกเลิกการลบ

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                              | ขั้นตอนการทดสอบ                                                                                                    | ข้อมูลการทดสอบ                        | ค่าคาดหวัง                                                              |
| ------------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------- | ----------------------------------------------------------------------- |
| TC-005        | กดปุ่ม "ยกเลิก"                               | 1. เปิด Dialog ยืนยันการลบ<br>2. กดปุ่ม "ยกเลิก"                                                                   | Dialog เปิดอยู่                       | ปิด Dialog และไม่มีการลบผู้ใช้                                          |
| TC-006        | กดปุ่ม X ปิด Dialog                           | 1. เปิด Dialog ยืนยันการลบ<br>2. กดปุ่ม X หรือคลิกนอก Dialog                                                       | Dialog เปิดอยู่                       | ปิด Dialog และไม่มีการลบผู้ใช้                                          |

## การยืนยันการลบ

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                              | ขั้นตอนการทดสอบ                                                                                                    | ข้อมูลการทดสอบ                        | ค่าคาดหวัง                                                              |
| ------------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------- | ----------------------------------------------------------------------- |
| TC-007        | ลบผู้ใช้สำเร็จ                                | 1. เปิด Dialog ยืนยันการลบ<br>2. กดปุ่ม "ลบ"                                                                       | userId = 5                            | เรียก DELETE /api/v1/users/5 และแสดง toast "ลบผู้ใช้สำเร็จ"             |
| TC-008        | รีเฟรชรายการหลังลบสำเร็จ                      | 1. ลบผู้ใช้สำเร็จ<br>2. ตรวจสอบตารางผู้ใช้                                                                         | ลบ userId = 5                         | รายการผู้ใช้ถูกรีเฟรช และไม่มี userId = 5 ในตาราง                       |
| TC-009        | ปิด Dialog หลังลบสำเร็จ                       | 1. ลบผู้ใช้สำเร็จ                                                                                                  | ลบสำเร็จ                              | Dialog ถูกปิดอัตโนมัติ                                                  |

## การจัดการ Error

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                              | ขั้นตอนการทดสอบ                                                                                                    | ข้อมูลการทดสอบ                        | ค่าคาดหวัง                                                              |
| ------------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------- | ----------------------------------------------------------------------- |
| TC-010        | ลบผู้ใช้ไม่สำเร็จ (Network error)             | 1. เปิด Dialog ยืนยันการลบ<br>2. ปิด network<br>3. กดปุ่ม "ลบ"                                                     | จำลอง network error                   | แสดง toast error "ลบผู้ใช้ไม่สำเร็จ"                                    |
| TC-011        | ลบผู้ใช้ไม่สำเร็จ (Server error)              | 1. เปิด Dialog ยืนยันการลบ<br>2. กดปุ่ม "ลบ"<br>3. Server return 500                                               | Server return status 500              | แสดง toast error "ลบผู้ใช้ไม่สำเร็จ"                                    |
| TC-012        | ลบผู้ใช้ที่ไม่มีในระบบ                        | 1. เปิด Dialog ยืนยันการลบ<br>2. กดปุ่ม "ลบ"<br>3. Server return 404                                               | userId ที่ไม่มีในระบบ                 | แสดง toast error หรือ handling ตามที่กำหนด                              |
| TC-013        | ลบผู้ใช้ที่มีข้อมูลที่เกี่ยวข้อง              | 1. เปิด Dialog ยืนยันการลบ<br>2. กดปุ่ม "ลบ"<br>3. ผู้ใช้มี FK constraint                                          | ผู้ใช้มีข้อมูลที่เกี่ยวข้อง           | Cascade delete หรือแสดง error ตามที่กำหนด                               |
| TC-014        | Database connection error                     | 1. เปิด Dialog ยืนยันการลบ<br>2. Database offline<br>3. กดปุ่ม "ลบ"                                                | Database offline                      | แสดง toast error และไม่ลบผู้ใช้                                         |

## การลบผู้ใช้ตาม Role

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                              | ขั้นตอนการทดสอบ                                                                                                    | ข้อมูลการทดสอบ                        | ค่าคาดหวัง                                                              |
| ------------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------- | ----------------------------------------------------------------------- |
| TC-015        | ลบผู้ใช้ที่เป็น FARMER                        | 1. เลือกลบผู้ใช้ที่มี role = FARMER<br>2. กดปุ่ม "ลบ"                                                              | user.role = "FARMER"                  | ลบ User และ Farmer (cascade delete)                                    |
| TC-016        | ลบผู้ใช้ที่เป็น AUDITOR                       | 1. เลือกลบผู้ใช้ที่มี role = AUDITOR<br>2. กดปุ่ม "ลบ"                                                             | user.role = "AUDITOR"                 | ลบ User และ Auditor (cascade delete)                                   |
| TC-017        | ลบผู้ใช้ที่เป็น COMMITTEE                     | 1. เลือกลบผู้ใช้ที่มี role = COMMITTEE<br>2. กดปุ่ม "ลบ"                                                           | user.role = "COMMITTEE"               | ลบ User และ Committee (cascade delete)                                 |
| TC-018        | ลบผู้ใช้ที่เป็น ADMIN                         | 1. เลือกลบผู้ใช้ที่มี role = ADMIN<br>2. กดปุ่ม "ลบ"                                                               | user.role = "ADMIN"                   | ลบ User และ Admin (cascade delete)                                     |
| TC-019        | ลบตัวเองไม่ได้                                | 1. Login เป็น Admin<br>2. พยายามลบ account ของตัวเอง                                                               | ลบ account ที่ login อยู่             | ไม่อนุญาตหรือแสดง error                                                 |

## กรณีทดสอบ Edge Case

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                              | ขั้นตอนการทดสอบ                                                                                                    | ข้อมูลการทดสอบ                        | ค่าคาดหวัง                                                              |
| ------------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------ | ------------------------------------- | ----------------------------------------------------------------------- |
| TC-020        | กดปุ่มลบซ้ำเร็วๆ                              | 1. เปิด Dialog ยืนยันการลบ<br>2. กดปุ่ม "ลบ" หลายครั้งติดต่อกัน                                                    | คลิกเร็วๆ 5 ครั้ง                     | เรียก API เพียงครั้งเดียว (ป้องกัน double delete)                       |
| TC-021        | ลบผู้ใช้ขณะมีผู้ใช้อื่นกำลังแก้ไข             | 1. ผู้ใช้ A เปิดหน้าแก้ไขผู้ใช้ X<br>2. ผู้ใช้ B ลบผู้ใช้ X<br>3. ผู้ใช้ A กดบันทึก                                 | Concurrent access                     | ผู้ใช้ A ได้รับ error ว่าผู้ใช้ไม่มีอยู่แล้ว                            |
| TC-022        | Console log เมื่อลบไม่สำเร็จ                  | 1. ลบผู้ใช้ไม่สำเร็จ<br>2. ตรวจสอบ console                                                                         | ลบไม่สำเร็จ                           | มี console.error("Delete failed:", error)                              |
