# แผนการทดสอบการแก้ไขข้อมูลคำขอใบรับรอง (Playwright E2E Testing)

**รวม 48 Test Cases**

> เอกสารนี้ออกแบบให้ “ใกล้เคียง” กับชุดทดสอบฝั่ง New แต่ปรับให้เป็น flow การแก้ไข (Edit) โดยเน้น: validation ที่สำคัญ, การโหลดข้อมูลเดิม, การแก้ไขรายการปลูก, และการยืนยัน/ส่งข้อมูล

## 1. Form Validation - Step 1: เลือกสวนยาง

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                     | ขั้นตอนการทดสอบ                                                                                    | ข้อมูลการทดสอบ            | ค่าคาดหวัง                                                                                 |
| ------------- | ------------------------------------ | -------------------------------------------------------------------------------------------------- | ------------------------- | ------------------------------------------------------------------------------------------ |
| TC-001        | แสดงรายการสวนยางที่เป็นของเกษตรกร    | 1. Login เป็นเกษตรกร<br>2. เข้าหน้า `/farmer/applications/edit`                                    | มีสวนยางอย่างน้อย 1 แปลง  | แสดงหัวข้อ “เลือกสวนยางที่ต้องการแก้ไข” และแสดง DataTable รายการสวนยาง                     |
| TC-002        | แสดง loading ระหว่างโหลดรายการสวนยาง | 1. Login เป็นเกษตรกร<br>2. เข้าหน้า `/farmer/applications/edit`                                    | ระบบกำลังโหลดรายการสวนยาง | แสดง loading/spinner ในส่วนรายการสวนยาง                                                    |
| TC-003        | ไม่มีสวนยางในระบบ                    | 1. Login เป็นเกษตรกร (ไม่มีสวนยาง)<br>2. เข้าหน้า `/farmer/applications/edit`                      | ไม่มีสวนยาง               | แสดงข้อความ “คุณยังไม่มีสวนยางในระบบ กรุณาลงทะเบียนสวนยางก่อน” และมีปุ่ม “ลงทะเบียนสวนยาง” |
| TC-004        | ปุ่ม “ลงทะเบียนสวนยาง” ไปหน้า New    | 1. ทำตาม TC-003<br>2. กดปุ่ม “ลงทะเบียนสวนยาง”                                                     | ไม่มีสวนยาง               | ไปหน้า `/farmer/applications/new`                                                          |
| TC-005        | แสดงคอลัมน์ตารางครบถ้วน              | 1. Login เป็นเกษตรกร<br>2. เข้าหน้าแก้ไข                                                           | มีสวนยาง                  | แสดงคอลัมน์: “รหัสสวน”, “สถานที่”, “จังหวัด”, “อำเภอ”, “ตำบล”                              |
| TC-006        | แสดงรหัสสวนรูปแบบ RFxxxxx            | 1. Login เป็นเกษตรกร<br>2. เข้าหน้าแก้ไข                                                           | rubberFarmId = 7          | แสดง “RF00007” ในคอลัมน์รหัสสวน                                                            |
| TC-007        | เลือกสวนยางโดยคลิกที่แถว             | 1. Login เป็นเกษตรกร<br>2. เข้าหน้าแก้ไข<br>3. คลิกที่แถวสวนยาง 1 แปลง                             | คลิกที่แถว                | แถวที่เลือกแสดง highlight และมี selection state                                            |
| TC-008        | ไม่เลือกสวนยางแล้วกด “ถัดไป”         | 1. Login เป็นเกษตรกร<br>2. เข้าหน้าแก้ไข<br>3. ไม่เลือกสวนยาง<br>4. กดปุ่ม “ถัดไป”                 | ไม่เลือกสวนยาง            | แสดง error “กรุณาเลือกสวนยางที่ต้องการแก้ไข”                                               |
| TC-009        | เปลี่ยนหน้า pagination               | 1. Login เป็นเกษตรกร (มีสวนยางหลายรายการ)<br>2. เข้าหน้าแก้ไข<br>3. เปลี่ยนหน้าใน pagination       | มีข้อมูลหลายหน้า          | แสดงข้อมูลชุดหน้าที่เลือก                                                                  |
| TC-010        | เปลี่ยนจำนวนรายการต่อหน้า            | 1. Login เป็นเกษตรกร (มีสวนยางหลายรายการ)<br>2. เข้าหน้าแก้ไข<br>3. เปลี่ยน rows ต่อหน้าเป็น 25/50 | มีข้อมูลหลายรายการ        | ตารางแสดงจำนวนรายการตามที่เลือก                                                            |
| TC-011        | เรียงลำดับคอลัมน์ (sortable)         | 1. Login เป็นเกษตรกร<br>2. เข้าหน้าแก้ไข<br>3. คลิกที่หัวคอลัมน์ “รหัสสวน” เพื่อ sort              | มีหลายแถว                 | ตารางถูกเรียงตามรหัสสวน                                                                    |
| TC-012        | เลือกสวนยางและไป Step 2              | 1. Login เป็นเกษตรกร<br>2. เข้าหน้าแก้ไข<br>3. เลือกสวนยาง 1 แปลง<br>4. กด “ถัดไป”                 | เลือกสวนยาง               | ไป Step 2 และแสดงหัวข้อ “ข้อมูลสวนยาง”                                                     |

## 2. Form Validation - Step 2: แก้ไขข้อมูลสวนยาง

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                                    | ขั้นตอนการทดสอบ                                                                                                                  | ข้อมูลการทดสอบ                     | ค่าคาดหวัง                                                           |
| ------------- | --------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------- | -------------------------------------------------------------------- |
| TC-013        | โหลดข้อมูลสวนยางเดิมขึ้นฟอร์ม                       | 1. ทำ TC-012 ให้สำเร็จ<br>2. รอโหลดข้อมูล                                                                                        | เลือกสวนยาง 1 แปลง                 | ฟอร์ม Step 2 แสดงข้อมูลเดิม (prefill)                                |
| TC-014        | ล้าง “หมู่บ้าน/ชุมชน” แล้วกด “ถัดไป”                | 1. อยู่ Step 2<br>2. ลบค่าหมู่บ้าน/ชุมชนให้ว่าง<br>3. กด “ถัดไป”                                                                 | villageName = ""                   | แสดง error “กรุณากรอกข้อมูลสวนยางให้ครบถ้วน”                         |
| TC-015        | ล้าง “หมู่ที่” (InputNumber) แล้วกด “ถัดไป”         | 1. อยู่ Step 2<br>2. ลบค่าหมู่ที่ให้ว่าง/0<br>3. กด “ถัดไป”                                                                      | moo = 0                            | แสดง error “กรุณากรอกข้อมูลสวนยางให้ครบถ้วน”                         |
| TC-016        | ล้าง “ถนน” แล้วกด “ถัดไป”                           | 1. อยู่ Step 2<br>2. ลบค่าถนน<br>3. กด “ถัดไป”                                                                                   | road = ""                          | แสดง error “กรุณากรอกข้อมูลสวนยางให้ครบถ้วน”                         |
| TC-017        | ล้าง “ซอย” แล้วกด “ถัดไป”                           | 1. อยู่ Step 2<br>2. ลบค่าซอย<br>3. กด “ถัดไป”                                                                                   | alley = ""                         | แสดง error “กรุณากรอกข้อมูลสวนยางให้ครบถ้วน”                         |
| TC-018        | ช่องจังหวัด/อำเภอ/ตำบล แสดงค่าเดิมและโต้ตอบได้      | 1. อยู่ Step 2<br>2. ตรวจสอบว่า dropdown จังหวัด/อำเภอ/ตำบล มีค่าเดิม (prefill)<br>3. คลิกเปิดแต่ละ dropdown เพื่อดูว่าโต้ตอบได้ | ข้อมูล prefill ครบถ้วน             | ช่อง dropdown จังหวัด/อำเภอ/ตำบล แสดงค่าเดิมและเปิดรายการตัวเลือกได้ |
| TC-019        | รูปแบบการจำหน่าย (productDistributionType) disabled | 1. อยู่ Step 2<br>2. พยายามคลิก/เปลี่ยน “รูปแบบการจำหน่าย”                                                                       | พยายามเปลี่ยนค่า                   | ช่องถูก disabled ไม่สามารถแก้ไขได้                                   |
| TC-020        | เปลี่ยนจังหวัดแล้วอำเภอ/ตำบลถูก reset               | 1. อยู่ Step 2<br>2. เปลี่ยนจังหวัด                                                                                              | เปลี่ยนจังหวัด                     | ค่าอำเภอและตำบลถูก reset เป็นค่าว่าง และต้องเลือกใหม่                |
| TC-021        | เปลี่ยนจังหวัดแล้วอำเภอ/ตำบลต้องเลือกใหม่จนผ่านได้  | 1. อยู่ Step 2<br>2. เปลี่ยนจังหวัด<br>3. เลือกอำเภอ<br>4. เลือกตำบล                                                             | เลือกจังหวัด/อำเภอ/ตำบลใหม่ครบถ้วน | ระบบยอมรับข้อมูล (ไม่แสดง error) และผ่านไป Step 3 ได้                |
| TC-022        | แก้ไขตำแหน่งบนแผนที่                                | 1. อยู่ Step 2<br>2. คลิกบนแผนที่ตำแหน่งใหม่                                                                                     | คลิกตำแหน่งใหม่บนแผนที่            | แสดง marker ใหม่ และข้อความพิกัดถูกอัปเดต                            |
| TC-023        | กด “ย้อนกลับ” จาก Step 2 กลับ Step 1                | 1. อยู่ Step 2<br>2. กด “ย้อนกลับ”                                                                                               | ไม่มี                              | กลับไป Step 1 และสวนยางที่เลือกยังคงถูกเลือกอยู่ (selection)         |
| TC-024        | กรอกข้อมูล Step 2 ถูกต้องแล้วไป Step 3              | 1. อยู่ Step 2<br>2. ทำให้ข้อมูลถูกต้องครบถ้วน<br>3. กด “ถัดไป”                                                                  | ข้อมูล Step 2 ถูกต้อง              | ไป Step 3 และแสดงหัวข้อ “รายละเอียดการปลูก”                          |
| TC-025        | ดึงข้อมูลสวนยางล้มเหลว                              | 1. เข้าหน้าแก้ไข<br>2. ทำให้ API ดึงข้อมูลล้มเหลว (mock/forced error)                                                            | API error                          | แสดง error “ไม่สามารถดึงข้อมูลสวนยางได้”                             |
| TC-026        | กลับมาที่ Step 2 แล้วข้อมูลยังคงอยู่                | 1. ไป Step 3 แล้วกด “ย้อนกลับ” กลับ Step 2                                                                                       | ไม่มี                              | ข้อมูลที่แก้ไขใน Step 2 ยังอยู่ครบถ้วน                               |

## 3. Form Validation - Step 3: แก้ไขรายละเอียดการปลูก

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                            | ขั้นตอนการทดสอบ                                                             | ข้อมูลการทดสอบ                 | ค่าคาดหวัง                                                      |
| ------------- | ------------------------------------------- | --------------------------------------------------------------------------- | ------------------------------ | --------------------------------------------------------------- |
| TC-027        | โหลดรายละเอียดการปลูกที่มีอยู่              | 1. ทำ Step 1-2 ให้สำเร็จ<br>2. ไป Step 3                                    | มีรายการปลูกอย่างน้อย 1 รายการ | แสดงรายการปลูกที่มีอยู่                                         |
| TC-028        | เพิ่มรายการปลูกใหม่                         | 1. อยู่ Step 3<br>2. กด “เพิ่มรายการปลูก”<br>3. กรอกข้อมูลรายการใหม่ครบถ้วน | เพิ่ม 1 รายการใหม่             | เพิ่มรายการใหม่ใน UI และยังสามารถไป Step 4 ได้                  |
| TC-029        | ลบรายการปลูกที่มีอยู่                       | 1. อยู่ Step 3<br>2. ลบรายการที่มีอยู่ 1 รายการ                             | ลบรายการที่มี plantingDetailId | รายการถูกลบออกจาก UI                                            |
| TC-030        | ลบรายการปลูกที่เพิ่งเพิ่ม                   | 1. อยู่ Step 3<br>2. เพิ่มรายการใหม่<br>3. ลบรายการใหม่ทันที                | ลบรายการที่เพิ่งเพิ่ม          | รายการใหม่ถูกลบออกจาก UI                                        |
| TC-031        | ลบจนไม่เหลือรายการปลูก แล้วกด “ถัดไป”       | 1. อยู่ Step 3<br>2. ลบรายการปลูกทั้งหมด<br>3. กด “ถัดไป”                   | ไม่มีรายการปลูก                | แสดง error “กรุณาเพิ่มรายละเอียดการปลูกอย่างน้อย 1 รายการ”      |
| TC-032        | ไม่เลือกพันธุ์ยางพารา แล้วกด “ถัดไป”        | 1. อยู่ Step 3<br>2. ทำให้รายการที่ 1 specie ว่าง<br>3. กด “ถัดไป”          | specie = ""                    | แสดง error “รายการที่ 1: กรุณาเลือกพันธุ์ยางพารา”               |
| TC-033        | ไม่กรอกพื้นที่แปลง แล้วกด “ถัดไป”           | 1. อยู่ Step 3<br>2. ทำให้รายการที่ 1 areaOfPlot ว่าง/null<br>3. กด “ถัดไป” | areaOfPlot = null/empty        | แสดง error “รายการที่ 1: กรุณากรอกพื้นที่แปลง”                  |
| TC-034        | กรอกพื้นที่แปลงเป็น 0 แล้วกด “ถัดไป”        | 1. อยู่ Step 3<br>2. กรอก areaOfPlot = 0<br>3. กด “ถัดไป”                   | areaOfPlot = 0                 | แสดง error “รายการที่ 1: กรุณากรอกพื้นที่แปลงให้ถูกต้อง”        |
| TC-035        | ไม่กรอกจำนวนต้นยางทั้งหมด แล้วกด “ถัดไป”    | 1. อยู่ Step 3<br>2. ทำให้ numberOfRubber ว่าง/null<br>3. กด “ถัดไป”        | numberOfRubber = null/empty    | แสดง error “รายการที่ 1: กรุณากรอกจำนวนต้นยางทั้งหมด”           |
| TC-036        | กรอกจำนวนต้นยางทั้งหมดเป็น 0 แล้วกด “ถัดไป” | 1. อยู่ Step 3<br>2. กรอก numberOfRubber = 0<br>3. กด “ถัดไป”               | numberOfRubber = 0             | แสดง error “รายการที่ 1: กรุณากรอกจำนวนต้นยางทั้งหมดให้ถูกต้อง” |
| TC-037        | กด “ย้อนกลับ” จาก Step 3 กลับ Step 2        | 1. อยู่ Step 3<br>2. กด “ย้อนกลับ”                                          | ไม่มี                          | กลับไป Step 2 และข้อมูลที่แก้ไว้ยังคงอยู่                       |
| TC-038        | กรอกข้อมูล Step 3 ถูกต้องแล้วไป Step 4      | 1. อยู่ Step 3<br>2. กรอกข้อมูลรายการปลูกให้ครบถ้วนถูกต้อง<br>3. กด “ถัดไป” | ข้อมูล Step 3 ถูกต้อง          | ไป Step 4 และแสดงหัวข้อ “ตรวจสอบและยืนยันข้อมูล”                |

## 4. Form Validation - Step 4: ตรวจสอบและยืนยันข้อมูล

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                          | ขั้นตอนการทดสอบ                                                                                      | ข้อมูลการทดสอบ    | ค่าคาดหวัง                                                                     |
| ------------- | ----------------------------------------- | ---------------------------------------------------------------------------------------------------- | ----------------- | ------------------------------------------------------------------------------ |
| TC-039        | แสดงสรุปข้อมูลสวนยางและรายละเอียดการปลูก  | 1. ทำ Step 1-3 ให้สำเร็จ<br>2. อยู่ Step 4                                                           | มีข้อมูลครบถ้วน   | แสดงสรุป “ข้อมูลสวนยาง” และ “รายละเอียดการปลูก”                                |
| TC-040        | ไม่ tick checkbox แล้วยืนยันส่งข้อมูล     | 1. อยู่ Step 4<br>2. ไม่ tick checkbox ยืนยัน<br>3. กดปุ่ม “บันทึกและส่งข้อมูล”                      | ไม่ tick checkbox | แสดง error “กรุณายืนยันความถูกต้องของข้อมูลก่อนส่ง”                            |
| TC-041        | tick checkbox แล้วยืนยันส่งข้อมูลสำเร็จ   | 1. อยู่ Step 4<br>2. tick checkbox ยืนยัน<br>3. กด “บันทึกและส่งข้อมูล”                              | tick checkbox     | แสดง success “อัปเดตข้อมูลสำเร็จ กำลังนำคุณไปยังหน้าหลัก...”                   |
| TC-042        | แสดง loading state ระหว่างส่งข้อมูล       | 1. อยู่ Step 4<br>2. tick checkbox<br>3. กด “บันทึกและส่งข้อมูล”                                     | กด submit         | ปุ่ม disable + แสดง loading และ label เป็น “กำลังบันทึก...”                    |
| TC-043        | ส่งข้อมูลล้มเหลว (ทั่วไป)                 | 1. อยู่ Step 4<br>2. tick checkbox<br>3. ทำให้ API อัปเดตล้มเหลว (mock/forced error)<br>4. กด submit | API error         | แสดง error “เกิดข้อผิดพลาดในการอัปเดตข้อมูล” (หรือข้อความ error จากระบบ)       |
| TC-044        | ส่งข้อมูลชนกัน (ข้อมูลถูกแก้ไขโดยผู้อื่น) | 1. อยู่ Step 4<br>2. tick checkbox<br>3. ทำให้ API ตอบกลับกรณี version conflict<br>4. กด submit      | version conflict  | แสดง error “ข้อมูลถูกแก้ไขโดยผู้ใช้อื่นแล้ว กรุณาโหลดข้อมูลใหม่และลองอีกครั้ง” |

## 5. UI/UX และ Navigation

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                             | ขั้นตอนการทดสอบ                                                 | ข้อมูลการทดสอบ | ค่าคาดหวัง                                                                          |
| ------------- | -------------------------------------------- | --------------------------------------------------------------- | -------------- | ----------------------------------------------------------------------------------- |
| TC-045        | แสดง Step Indicator 4 steps พร้อมชื่อขั้นตอน | 1. เข้าหน้าแก้ไข<br>2. ดู StepIndicator                         | ไม่มี          | แสดงชื่อขั้นตอน: “เลือกสวนยาง”, “ข้อมูลสวนยาง”, “รายละเอียดการปลูก”, “ยืนยันข้อมูล” |
| TC-046        | Step 1 ไม่มีปุ่ม “ย้อนกลับ”                  | 1. เข้าหน้าแก้ไข<br>2. อยู่ Step 1                              | ไม่มี          | ไม่แสดงปุ่ม “ย้อนกลับ”                                                              |
| TC-047        | Step 4 แสดงปุ่ม submit “บันทึกและส่งข้อมูล”  | 1. ไป Step 4                                                    | ไม่มี          | แสดงปุ่ม “บันทึกและส่งข้อมูล” และปุ่ม “ถัดไป” ไม่แสดงแล้ว                           |
| TC-048        | Responsive design (desktop/tablet/mobile)    | 1. เข้าหน้าแก้ไข<br>2. ปรับ viewport เป็น desktop/tablet/mobile | เปลี่ยนขนาด    | หน้าแสดงผลได้ถูกต้อง (หัวข้อ/ปุ่มหลัก/ตารางหรือฟอร์มยังใช้งานได้)                   |
