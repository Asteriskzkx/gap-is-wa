# แผนการทดสอบการติดตามสถานะการรับรอง (Playwright E2E Testing)

**รวม 38 Test Cases (เฉพาะเคสที่ทำ E2E ด้วย Playwright ได้จริง)**

> หน้าเป้าหมาย: `/farmer/applications` (ไฟล์ `src/app/farmer/applications/page.tsx`)
>
> แนวทางการคัดเลือกเคส:
>
> - เน้นผลลัพธ์ที่ผู้ใช้เห็น/โต้ตอบได้จริง (DOM assertions)
> - ตัดเคสที่เป็นการตรวจ implementation ภายใน เช่น ตรวจ config ของ DataTable, ตรวจ class/style เฉพาะ, ตรวจ useEffect deps
> - เคส error สามารถทำได้ด้วยการ mock network (เช่น `page.route`) หรือจัดสภาพแวดล้อมให้ API ตอบ error

## 1. การเข้าถึงหน้าและการแสดงผลพื้นฐาน

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                       | ขั้นตอนการทดสอบ                                                                                    | ข้อมูลการทดสอบ | ค่าคาดหวัง                                               |
| ------------- | -------------------------------------- | -------------------------------------------------------------------------------------------------- | -------------- | -------------------------------------------------------- |
| TC-001        | ไม่ได้ login แล้วเข้าหน้า applications | 1. ไม่ได้ login<br>2. เปิดหน้า `/farmer/applications`                                              | ไม่มี session  | ระบบ redirect ไปหน้า login (หรือหน้าที่ระบบกำหนด)        |
| TC-002        | แสดงหัวข้อและคำอธิบายหน้า              | 1. Login เป็นเกษตรกร<br>2. เปิดหน้า `/farmer/applications`                                         | มี session     | เห็นหัวข้อ “ติดตามสถานะการรับรอง” และ subtitle ตามหน้าจอ |
| TC-003        | แสดง loading ระหว่างดึงข้อมูล          | 1. Login เป็นเกษตรกร<br>2. เปิดหน้า `/farmer/applications`                                         | API ตอบช้า     | เห็น DataTable อยู่ในสถานะ loading/spinner               |
| TC-004        | แสดง error เมื่อ API ดึงข้อมูลล้มเหลว  | 1. Login เป็นเกษตรกร<br>2. เปิดหน้า `/farmer/applications`<br>3. ทำให้ API ตอบ error (mock/forced) | API error      | แสดงข้อความ error (ตัวอักษรสีแดง) และไม่ crash           |

## 2. Empty state (ไม่มีสวนยาง/ไม่มีรายการ)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                  | ขั้นตอนการทดสอบ                                            | ข้อมูลการทดสอบ    | ค่าคาดหวัง                                                            |
| ------------- | --------------------------------- | ---------------------------------------------------------- | ----------------- | --------------------------------------------------------------------- |
| TC-005        | ไม่มีข้อมูลแล้วแสดงกล่องแจ้งเตือน | 1. Login เป็นเกษตรกร<br>2. เปิดหน้า `/farmer/applications` | applications ว่าง | แสดงข้อความ “ยังไม่มีข้อมูลสวนยาง” และคำอธิบายแนะนำให้ลงทะเบียนสวนยาง |
| TC-006        | ปุ่ม “ลงทะเบียนสวนยาง” ไปหน้า New | 1. ทำตาม TC-005<br>2. กดปุ่ม “ลงทะเบียนสวนยาง”             | applications ว่าง | ไปหน้า `/farmer/applications/new`                                     |
| TC-007        | Empty state ไม่แสดงตาราง          | 1. ทำตาม TC-005                                            | applications ว่าง | ไม่แสดง DataTable รายการสวนยาง                                        |

## 3. การแสดงตารางรายการ (คอลัมน์/ข้อมูลหลัก)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                                  | ขั้นตอนการทดสอบ                                            | ข้อมูลการทดสอบ                                       | ค่าคาดหวัง                                                                                                             |
| ------------- | ------------------------------------------------- | ---------------------------------------------------------- | ---------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- |
| TC-008        | มีข้อมูลแล้วแสดง DataTable                        | 1. Login เป็นเกษตรกร<br>2. เปิดหน้า `/farmer/applications` | มีรายการอย่างน้อย 1 รายการ                           | แสดง DataTable พร้อมข้อมูลอย่างน้อย 1 แถว                                                                              |
| TC-009        | แสดงคอลัมน์หลักครบถ้วน                            | 1. ทำตาม TC-008<br>2. ตรวจสอบหัวคอลัมน์                    | มีข้อมูล                                             | มีคอลัมน์: “รหัสสวน”, “สถานที่”, “จังหวัด”, “อำเภอ”, “ตำบล”, “กำหนดการตรวจประเมิน”, “สถานะ” และคอลัมน์ปุ่มดูรายละเอียด |
| TC-010        | แสดงรหัสสวนจาก `farmId` เมื่อมีค่า                | 1. ทำตาม TC-008                                            | rubberFarm.farmId มีค่า (เช่น RF00123)               | คอลัมน์ “รหัสสวน” แสดงตาม `farmId`                                                                                     |
| TC-011        | แสดงรหัสสวนจาก `rubberFarmId` เมื่อไม่มี `farmId` | 1. ทำตาม TC-008                                            | farmId = null และ rubberFarmId = 1 (หรือตามที่กำหนด) | คอลัมน์ “รหัสสวน” แสดง “RF00001” หรือ RFXXXXX ตามที่กำหนด (padStart 5 digits)                                          |
| TC-012        | แสดงสถานที่จาก `location` เมื่อมีค่า              | 1. ทำตาม TC-008                                            | rubberFarm.location มีค่า                            | คอลัมน์ “สถานที่” แสดงค่าจาก `location`                                                                                |
| TC-013        | แสดงสถานที่ fallback เป็น “หมู่บ้าน … หมู่ …”     | 1. ทำตาม TC-008                                            | location = null แต่มี villageName + moo              | คอลัมน์ “สถานที่” แสดงรูปแบบ “{villageName} หมู่ {moo}”                                                                |
| TC-014        | แสดงกำหนดการตรวจประเมินเป็น “-” เมื่อไม่มี        | 1. ทำตาม TC-008                                            | inspection หรือ inspectionDateAndTime เป็น null      | คอลัมน์ “กำหนดการตรวจประเมิน” แสดง “-”                                                                                 |
| TC-015        | แสดงกำหนดการตรวจประเมินเป็นวันที่ภาษาไทย          | 1. ทำตาม TC-008                                            | inspectionDateAndTime มีค่า                          | คอลัมน์ “กำหนดการตรวจประเมิน” แสดงวันที่ที่ถูก format เป็นภาษาไทย                                                      |

## 4. การแสดงสถานะ (badge)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                 | ขั้นตอนการทดสอบ                                            | ข้อมูลการทดสอบ                                                                   | ค่าคาดหวัง                                  |
| ------------- | -------------------------------- | ---------------------------------------------------------- | -------------------------------------------------------------------------------- | ------------------------------------------- |
| TC-016        | สถานะ “รอกำหนดวันตรวจประเมิน”    | 1. Login เป็นเกษตรกร<br>2. เปิดหน้า `/farmer/applications` | inspection = null                                                                | แสดงข้อความสถานะ “รอกำหนดวันตรวจประเมิน”    |
| TC-017        | สถานะ “รอการตรวจประเมิน”         | 1. ทำตาม TC-008                                            | inspectionStatus = “รอการตรวจประเมิน”                                            | แสดงข้อความสถานะ “รอการตรวจประเมิน”         |
| TC-018        | สถานะ “ตรวจประเมินแล้ว รอสรุปผล” | 1. ทำตาม TC-008                                            | inspectionStatus = “ตรวจประเมินแล้ว” และ inspectionResult = “รอผลการตรวจประเมิน” | แสดงข้อความสถานะ “ตรวจประเมินแล้ว รอสรุปผล” |
| TC-019        | สถานะ “ผ่านการรับรอง”            | 1. ทำตาม TC-008                                            | inspectionStatus = “ตรวจประเมินแล้ว” และ inspectionResult = “ผ่าน”               | แสดงข้อความสถานะ “ผ่านการรับรอง”            |
| TC-020        | สถานะ “ไม่ผ่านการรับรอง”         | 1. ทำตาม TC-008                                            | inspectionStatus = “ตรวจประเมินแล้ว” และ inspectionResult = “ไม่ผ่าน”            | แสดงข้อความสถานะ “ไม่ผ่านการรับรอง”         |

## 5. Pagination และ Sorting (พฤติกรรมที่ตรวจได้จาก UI)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                     | ขั้นตอนการทดสอบ                                            | ข้อมูลการทดสอบ             | ค่าคาดหวัง                                       |
| ------------- | ------------------------------------ | ---------------------------------------------------------- | -------------------------- | ------------------------------------------------ |
| TC-021        | แสดง paginator เมื่อมีหลายรายการ     | 1. Login เป็นเกษตรกร<br>2. เปิดหน้า `/farmer/applications` | มีข้อมูลมากกว่า 10 รายการ  | เห็นส่วน pagination/paginator                    |
| TC-022        | เปลี่ยนหน้า pagination               | 1. ทำตาม TC-021<br>2. ไปหน้า 2 ใน paginator                | มีข้อมูลมากกว่า 10 รายการ  | ตารางเปลี่ยนไปแสดงข้อมูลหน้าถัดไป                |
| TC-023        | เปลี่ยนจำนวนรายการต่อหน้าเป็น 25     | 1. ทำตาม TC-021<br>2. เปลี่ยน rows ต่อหน้าเป็น 25          | มีข้อมูลมากกว่า 25 รายการ  | ตารางแสดงจำนวนแถวต่อหน้าตามที่เลือก              |
| TC-024        | เปลี่ยนจำนวนรายการต่อหน้าเป็น 50     | 1. ทำตาม TC-021<br>2. เปลี่ยน rows ต่อหน้าเป็น 50          | มีข้อมูลมากกว่า 50 รายการ  | ตารางแสดงจำนวนแถวต่อหน้าตามที่เลือก              |
| TC-025        | เรียงลำดับตาม “รหัสสวน” (ascending)  | 1. ทำตาม TC-008<br>2. คลิกหัวคอลัมน์ “รหัสสวน” 1 ครั้ง     | มีหลายแถวและรหัสต่างกัน    | ตารางเรียงตามรหัสสวนจากน้อยไปมาก                 |
| TC-026        | เรียงลำดับตาม “รหัสสวน” (descending) | 1. ทำตาม TC-025<br>2. คลิกหัวคอลัมน์ “รหัสสวน” อีกครั้ง    | มีหลายแถว                  | ตารางเรียงตามรหัสสวนจากมากไปน้อย                 |
| TC-027        | เรียงลำดับตาม “จังหวัด”              | 1. ทำตาม TC-008<br>2. คลิกหัวคอลัมน์ “จังหวัด”             | มีหลายแถวและจังหวัดต่างกัน | ตารางเรียงตามจังหวัด (ตรวจได้จากลำดับที่เปลี่ยน) |

## 6. ดูคำแนะนำและข้อบกพร่อง (Dialog)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                                               | ขั้นตอนการทดสอบ                                    | ข้อมูลการทดสอบ                     | ค่าคาดหวัง                                                                     |
| ------------- | -------------------------------------------------------------- | -------------------------------------------------- | ---------------------------------- | ------------------------------------------------------------------------------ |
| TC-028        | แสดงปุ่มดูรายละเอียด (ไอคอนตา) ในทุกแถว                        | 1. ทำตาม TC-008<br>2. ตรวจสอบคอลัมน์ปุ่มในแต่ละแถว | มีข้อมูลหลายแถว                    | ทุกแถวมีปุ่มไอคอนรูปตา (eye)                                                   |
| TC-029        | ปุ่มดูรายละเอียด disabled เมื่อไม่มีข้อมูลคำแนะนำ/ข้อบกพร่อง   | 1. ทำตาม TC-008                                    | inspection.adviceAndDefect = null  | ปุ่ม eye ถูก disabled / กดแล้วไม่เปิด dialog                                   |
| TC-030        | ปุ่มดูรายละเอียด enabled เมื่อมีข้อมูลคำแนะนำ/ข้อบกพร่อง       | 1. ทำตาม TC-008                                    | inspection.adviceAndDefect != null | ปุ่ม eye สามารถกดได้                                                           |
| TC-031        | กดปุ่ม eye แล้วเปิด dialog สำเร็จ                              | 1. ทำตาม TC-030<br>2. กดปุ่ม eye                   | มี adviceAndDefect                 | เปิด dialog และเห็นหัวข้อ “ข้อมูลการให้คำปรึกษาและข้อบกพร่อง”                  |
| TC-032        | แสดงส่วน “ข้อมูลการตรวจประเมิน” ใน dialog                      | 1. ทำตาม TC-031                                    | มี inspectionNo และ date           | เห็นหัวข้อย่อย “ข้อมูลการตรวจประเมิน” และมี field “รหัสการตรวจ”/“วันที่บันทึก” |
| TC-033        | มีรายการให้คำปรึกษาแล้วแสดงการ์ดรายการ                         | 1. ทำตาม TC-031                                    | adviceList มีอย่างน้อย 1 รายการ    | เห็นหัวข้อ “รายการให้คำปรึกษา” และเห็นข้อมูลรายการอย่างน้อย 1 รายการ           |
| TC-034        | ไม่มีรายการให้คำปรึกษาแล้วแสดงข้อความ “ไม่มีรายการให้คำปรึกษา” | 1. ทำตาม TC-031                                    | adviceList ว่างหรือไม่ส่งมา        | แสดงข้อความ “ไม่มีรายการให้คำปรึกษา”                                           |
| TC-035        | มีข้อบกพร่องแล้วแสดงการ์ดข้อบกพร่อง                            | 1. ทำตาม TC-031                                    | defectList มีอย่างน้อย 1 รายการ    | เห็นหัวข้อ “ข้อบกพร่อง” และเห็นข้อมูลข้อบกพร่องอย่างน้อย 1 รายการ              |
| TC-036        | ไม่มีข้อบกพร่องแล้วแสดงข้อความ “ไม่มีข้อบกพร่อง”               | 1. ทำตาม TC-031                                    | defectList ว่างหรือไม่ส่งมา        | แสดงข้อความ “ไม่มีข้อบกพร่อง”                                                  |
| TC-037        | ปิด dialog ด้วยปุ่ม “ปิด”                                      | 1. ทำตาม TC-031<br>2. กดปุ่ม “ปิด”                 | dialog เปิดอยู่                    | dialog ถูกปิด และกลับมาที่หน้า DataTable                                       |

## 7. Responsive (smoke)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                    | ขั้นตอนการทดสอบ                                                                        | ข้อมูลการทดสอบ    | ค่าคาดหวัง                                                |
| ------------- | ----------------------------------- | -------------------------------------------------------------------------------------- | ----------------- | --------------------------------------------------------- |
| TC-038        | แสดงผลได้บน mobile viewport (smoke) | 1. Login เป็นเกษตรกร<br>2. ตั้ง viewport เป็น mobile<br>3. เปิด `/farmer/applications` | เปลี่ยนขนาดหน้าจอ | หน้าใช้งานได้ (เห็นหัวข้อ และตาราง/empty-state โต้ตอบได้) |
