# แผนการทดสอบบันทึกข้อมูลประจำสวนยาง (Playwright E2E Testing)

เอกสารนี้คงไว้เฉพาะกรณีทดสอบที่ทำ E2E ด้วย Playwright ได้จริง โดยยึดพฤติกรรมที่ผู้ใช้เห็นในหน้า “บันทึกข้อมูลประจำสวนยาง” เท่านั้น

## ขอบเขต

### In-scope (ทำได้ด้วย E2E)

- การแสดงผลหัวข้อหน้า + StepIndicator
- การใช้งาน Step 1: ตัวกรองพื้นที่ (จังหวัด/อำเภอ/ตำบล), ปุ่ม “ค้นหา”/“ล้างค่า”, ปุ่มแท็บ 2 อัน, ตาราง, pagination/sort ขั้นพื้นฐาน, เลือกแถว, ไป Step 2
- การใช้งาน Step 2: เพิ่ม/ลบรายการ (ปลูก/ปุ๋ย/ศัตรูพืช/พืชข้างเคียง), เปิด-ปิดช่องกรอกตาม checkbox, ปุ่ม “ย้อนกลับ”, บันทึกและตรวจ toast

### Out-of-scope (ไม่ใช่ E2E หรือไม่เสถียร)

- ตรวจสอบ payload, state ภายใน, optimistic lock/version, console error
- ตรวจ maxLength/จำนวนแถวของ textarea/Responsive layout แบบละเอียด
- ตรวจความถูกต้องของแผนที่เชิงพิกัด/การ render แบบ pixel-perfect

## เงื่อนไขก่อนทดสอบ

- Login เป็น Auditor สำเร็จ
- มีข้อมูล Inspection อย่างน้อย:
  - กลุ่ม “อยู่ระหว่างการตรวจประเมิน” และ “ตรวจประเมินเสร็จแล้ว”
  - อย่างน้อย 1 รายการที่ “มีข้อมูลบันทึกแล้ว” (Update/Prefill)

## Step 1 — เลือกการตรวจประเมิน

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                     | ขั้นตอนการทดสอบ                                          | ค่าคาดหวัง                                                                              |
| ------------- | ------------------------------------ | -------------------------------------------------------- | --------------------------------------------------------------------------------------- |
| TC-001        | แสดงชื่อหน้า + คำอธิบาย              | 1) เข้าหน้า “บันทึกข้อมูลประจำสวนยาง”                    | เห็นชื่อหน้า “บันทึกข้อมูลประจำสวนยาง” และคำอธิบายใต้หัวข้อ                             |
| TC-002        | StepIndicator แสดง 2 ขั้น            | 1) อยู่หน้าเดิม                                          | เห็น StepIndicator และมีข้อความขั้น “เลือกการตรวจประเมิน” และ “บันทึกข้อมูลประจำสวนยาง” |
| TC-003        | ตารางแสดงสถานะกำลังโหลด              | 1) เข้า Step 1 ขณะโหลดรายการ                             | ตารางแสดงสถานะ loading และเมื่อโหลดเสร็จจะแสดงข้อมูล                                    |
| TC-004        | ตารางมีหัวคอลัมน์ครบ                 | 1) รอโหลดเสร็จ 2) ตรวจหัวคอลัมน์                         | พบหัวคอลัมน์: “รหัสการตรวจ”, “วันที่ตรวจ”, “ประเภท”, “สถานที่”, “เกษตรกร”               |
| TC-005        | เปลี่ยนหน้า (pagination)             | 1) มีข้อมูลหลายหน้า 2) กดเปลี่ยนหน้าจาก paginator        | รายการในตารางเปลี่ยนตามหน้าที่เลือก                                                     |
| TC-006        | เปลี่ยนจำนวนรายการต่อหน้า            | 1) เปลี่ยน rows ต่อหน้าเป็น 25 (หรือ 50)                 | จำนวนรายการที่แสดงต่อหน้าเปลี่ยนตามที่เลือก                                             |
| TC-007        | Sort ขั้นพื้นฐาน                     | 1) คลิกหัวคอลัมน์ที่ sortable (เช่น “รหัสการตรวจ”)       | มีสัญลักษณ์ sort/ลำดับในตารางเปลี่ยน (ยืนยันจาก UI)                                     |
| TC-008        | เลือกจังหวัด → อำเภอ enable          | 1) เลือก “จังหวัด” 2) สังเกต “อำเภอ/เขต” และ “ตำบล/แขวง” | “อำเภอ/เขต” enable; “ตำบล/แขวง” ยัง disabled จนกว่าจะเลือกอำเภอ                         |
| TC-009        | เลือกอำเภอ → ตำบล enable             | 1) เลือกจังหวัด 2) เลือก “อำเภอ/เขต”                     | “ตำบล/แขวง” enable และเลือกได้                                                          |
| TC-010        | เปลี่ยนจังหวัดแล้วรีเซ็ตอำเภอ/ตำบล   | 1) เลือกจังหวัด+อำเภอ+ตำบล 2) เปลี่ยนจังหวัดเป็นค่าอื่น  | ค่าอำเภอและตำบลถูกรีเซ็ต และ “ตำบล/แขวง” กลับไป disabled จนเลือกอำเภอใหม่               |
| TC-011        | เปลี่ยนอำเภอแล้วรีเซ็ตตำบล           | 1) เลือกจังหวัด+อำเภอ+ตำบล 2) เปลี่ยนอำเภอเป็นค่าอื่น    | ค่าตำบลถูกรีเซ็ต                                                                        |
| TC-012        | ปุ่ม “ล้างค่า” รีเซ็ตตัวกรอง         | 1) ตั้งค่า filter อย่างน้อย 1 ช่อง 2) กด “ล้างค่า”       | จังหวัด/อำเภอ/ตำบลถูกล้างทั้งหมด                                                        |
| TC-013        | ปุ่ม “ค้นหา” รีเฟรชรายการ            | 1) ตั้งค่า filter 2) กด “ค้นหา”                          | ตารางแสดง loading แล้วรีเฟรชรายการตามเงื่อนไขค้นหา                                      |
| TC-014        | สลับแท็บ “อยู่ระหว่างการตรวจประเมิน” | 1) กดปุ่ม “อยู่ระหว่างการตรวจประเมิน”                    | ตารางรีโหลดรายการของแท็บนี้ (สังเกต loading/ข้อมูลเปลี่ยน)                              |
| TC-015        | สลับแท็บ “ตรวจประเมินเสร็จแล้ว”      | 1) กดปุ่ม “ตรวจประเมินเสร็จแล้ว”                         | ตารางรีโหลดรายการของแท็บนี้ (สังเกต loading/ข้อมูลเปลี่ยน)                              |
| TC-016        | เลือกแถวแล้วปุ่ม “ถัดไป” ใช้งานได้   | 1) คลิกเลือกแถวหนึ่งในตาราง                              | แถวถูก highlight และปุ่ม “ถัดไป” enable                                                 |
| TC-017        | ไป Step 2 ได้เมื่อเลือกแถว           | 1) เลือกแถว 2) กด “ถัดไป”                                | ไป Step 2 และเห็นหัวข้อ “แผนที่ตั้งสวน” และ “1. พันธุ์ยางพาราที่ปลูก”                   |

## Step 2 — บันทึกข้อมูลประจำสวนยาง

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                                                    | ขั้นตอนการทดสอบ                                                                                                                                  | ค่าคาดหวัง                                                           |
| ------------- | ------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------- |
| TC-018        | ปุ่ม “ย้อนกลับ” กลับไป Step 1                                       | 1) อยู่ Step 2 2) กด “ย้อนกลับ”                                                                                                                  | กลับไป Step 1 โดยยังอยู่หน้าเดิม                                     |
| TC-019        | เพิ่ม/ลบรายการปลูก                                                  | 1) กด “เพิ่มรายการปลูก” 2) ตรวจว่ามีรายการเพิ่ม 3) กด “ลบรายการ” ในรายการที่เพิ่ม                                                                | เพิ่มแถวได้ และเมื่อมีมากกว่า 1 แถวจะมีปุ่ม “ลบรายการ” เพื่อเอาออก   |
| TC-020        | กรอกข้อมูลรายการปลูก 1 แถว                                          | 1) ในหัวข้อ “1. พันธุ์ยางพาราที่ปลูก” เลือก “พันธุ์ยางพารา” (เช่น “RRIT 251”) 2) กรอก “ระยะปลูก (เมตร)” 3) กรอก “จำนวนต้น” 4) เลือก “วันที่ปลูก” | ค่าที่กรอก/เลือกยังคงอยู่ในฟอร์ม                                     |
| TC-021        | ระบบการให้น้ำ: เลือก “ไม่มี” → ช่อง “ระบุ” disabled                 | 1) ในหัวข้อ “2. ระบบการให้น้ำ” เลือก “ไม่มี”                                                                                                     | ช่อง “ระบุ” (placeholder “ระบุรายละเอียดระบบการให้น้ำ”) ถูก disabled |
| TC-022        | ระบบการให้น้ำ: เลือก “มี” → ช่อง “ระบุ” enable                      | 1) เลือก “มี”                                                                                                                                    | ช่อง “ระบุ” enable และกรอกได้                                        |
| TC-023        | ปุ๋ยเคมี: เพิ่ม/ลบรายการ                                            | 1) ในหัวข้อ “ปุ๋ยเคมี” กด “เพิ่มปุ๋ยเคมี” 2) เมื่อมี >1 รายการ กดปุ่ม “ลบ” ของรายการหนึ่ง                                                        | เพิ่มรายการได้ และลบได้                                              |
| TC-024        | ปุ๋ยเคมี: กรอกข้อมูลรายการ                                          | 1) กรอก “สูตร/ชื่อปุ๋ย” 2) กรอก “อัตรา” 3) กรอก “จำนวน” (placeholder “ครั้ง/ปี”)                                                                 | ค่าที่กรอกยังคงอยู่                                                  |
| TC-025        | ปุ๋ยอินทรีย์: เพิ่ม/ลบรายการ                                        | 1) ในหัวข้อ “ปุ๋ยอินทรีย์ / น้ำหมัก” กด “เพิ่มปุ๋ยอินทรีย์” 2) เมื่อมี >1 รายการ กด “ลบ”                                                         | เพิ่มรายการได้ และลบได้                                              |
| TC-026        | ปุ๋ยอื่นๆ: เพิ่ม/ลบรายการ                                           | 1) ในหัวข้อ “อื่นๆ” กด “เพิ่มรายการอื่นๆ” 2) เมื่อมี >1 รายการ กด “ลบ”                                                                           | เพิ่มรายการได้ และลบได้                                              |
| TC-027        | ประวัติการใช้พื้นที่: เลือก “ใช้ประโยชน์” → ช่องปี enable           | 1) เลือก “พื้นที่ใช้ประโยชน์ทางการเกษตร…” 2) ตรวจช่อง “ปีที่ 1”/“ปีที่ 2”                                                                        | ช่องปีถูก enable และกรอกได้                                          |
| TC-028        | ประวัติการใช้พื้นที่: เลือก “ไม่เคยใช้ประโยชน์” → ปิด used + ล้างปี | 1) เลือก “พื้นที่ใช้ประโยชน์…” และกรอกปี 2) เลือก “พื้นที่ไม่เคยใช้ประโยชน์ทางการเกษตร”                                                          | ตัวเลือก used ถูกปิด และค่าช่องปีถูกล้าง/กลับเป็น disabled           |
| TC-029        | ศัตรูพืช/โรค: เพิ่ม/ลบรายการ                                        | 1) ในหัวข้อ “5. การแพร่ระบาด…” กด “เพิ่มรายการ” 2) เมื่อมี >1 รายการ กด “ลบรายการ”                                                               | เพิ่มรายการได้ และลบได้                                              |
| TC-030        | ศัตรูพืช/โรค: กรอกข้อมูลรายการ                                      | 1) กรอก “ชื่อศัตรูพืช/โรค/อาการ” 2) กรอก “ช่วงที่ระบาด” 3) กรอก “วิธีการป้องกันและควบคุม”                                                        | ค่าที่กรอกยังคงอยู่                                                  |
| TC-031        | พืชข้างเคียง: เลือก “ไม่มี” → ปิดการกรอกและปุ่มเพิ่ม                | 1) เลือก “ไม่มี” ในหัวข้อ “6. ชนิดของพืชที่ปลูกข้างเคียงสวนยาง”                                                                                  | ช่อง “ชนิดพืช” disabled และปุ่ม “เพิ่มรายการ” disabled               |
| TC-032        | พืชข้างเคียง: เลือก “มี” → กรอก/เพิ่ม/ลบ ได้                        | 1) เลือก “มี” 2) กรอก “ชนิดพืช” 3) กด “เพิ่มรายการ” 4) เมื่อมี >1 รายการ กด “ลบรายการ”                                                           | ช่องและปุ่ม enable, เพิ่ม/ลบรายการทำงาน                              |
| TC-033        | ข้อมูลเพิ่มเติม: กรอกได้                                            | 1) กรอกใน “ข้อมูลเพิ่มเติม” (placeholder “ระบุข้อมูลอื่น ๆ เช่น ชนิดพืชร่วม พืชแซม หรือข้อมูลเพิ่มเติมอื่น ๆ”)                                   | ค่าที่กรอกยังคงอยู่                                                  |

## การบันทึกข้อมูล (Update/Error)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                | ขั้นตอนการทดสอบ                                                                                            | ค่าคาดหวัง                                                                   |
| ------------- | ------------------------------- | ---------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------- |
| TC-034        | Update สำเร็จแสดง toast         | 1) เลือก Inspection ที่มีข้อมูลบันทึกแล้ว 2) ไป Step 2 3) แก้ไขค่าในฟอร์ม 4) กด “บันทึกข้อมูล”             | เห็น toast “บันทึกข้อมูลเรียบร้อย”                                           |
| TC-035        | บันทึกไม่สำเร็จแสดง toast error | 1) Mock ให้ API บันทึกล้มเหลว (500/timeout) 2) กด “บันทึกข้อมูล”                                           | เห็น toast error เป็นข้อความจาก server หรือ fallback “บันทึกข้อมูลไม่สำเร็จ” |
