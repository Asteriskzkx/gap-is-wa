# แผนการทดสอบบันทึกการให้คำปรึกษาและข้อบกพร่อง

## Step 1: เลือกการตรวจประเมิน

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                          | ขั้นตอนการทดสอบ                                                                                                                   | ข้อมูลการทดสอบ                                                         | ค่าคาดหวัง                                                                                                  |
| ------------- | ----------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- |
| TC-001        | Loading state เมื่อโหลดรายการ             | 1. Login เป็น Auditor<br>2. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"                                                          | มี network latency / โหลดข้อมูลจาก API                                 | ตารางแสดงสถานะกำลังโหลด (loading) และเมื่อโหลดเสร็จจะแสดงข้อมูล                                             |
| TC-002        | แสดงตาราง 5 คอลัมน์ครบถ้วน                | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"<br>2. ตรวจสอบหัวคอลัมน์ในตาราง                                                    | ไม่มี                                                                  | แสดงหัวคอลัมน์: รหัสการตรวจ, วันที่ตรวจ, ประเภท, สถานที่, เกษตรกร                                           |
| TC-003        | แสดงข้อมูลวันที่ตรวจรูปแบบไทย             | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"<br>2. ตรวจสอบคอลัมน์ "วันที่ตรวจ"                                                 | inspectionDateAndTime มีค่า (เช่น 2025-12-01T10:00:00Z)                | แสดงวันที่ด้วยรูปแบบภาษาไทย (th-TH) และถ้าไม่มีค่าให้แสดง "-"                                               |
| TC-004        | แสดง "สถานที่" จากข้อมูลสวนยาง            | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"<br>2. ตรวจสอบคอลัมน์ "สถานที่"                                                    | rubberFarm มี villageName/subDistrict/district/province บางส่วนหรือครบ | คอลัมน์ "สถานที่" แสดงข้อความที่ join ด้วยช่องว่างจากค่าที่มี (ตัดค่าว่างออก) และถ้าไม่มีทั้งหมดให้แสดง "-" |
| TC-005        | แสดงชื่อเกษตรกร                           | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"<br>2. ตรวจสอบคอลัมน์ "เกษตรกร"                                                    | rubberFarm.farmer มี namePrefix/firstName/lastName                     | แสดง "คำนำหน้า + ชื่อ + นามสกุล"; หากไม่มีข้อมูลเกษตรกรให้แสดง "ไม่ระบุ"                                    |
| TC-006        | แสดงรหัสการตรวจ                           | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"<br>2. ตรวจสอบคอลัมน์ "รหัสการตรวจ"                                                | inspectionNo = "INS-2025-001"                                          | แสดงรหัสการตรวจ "INS-2025-001" หรือ "-" ถ้าไม่มี                                                            |
| TC-007        | แสดงประเภทการตรวจ                         | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"<br>2. ตรวจสอบคอลัมน์ "ประเภท"                                                     | inspectionType.typeName = "ตรวจประเมินแปลง"                            | แสดงประเภท "ตรวจประเมินแปลง" หรือ "ไม่ระบุ" ถ้าไม่มี                                                        |
| TC-008        | เปลี่ยนหน้า pagination                    | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"<br>2. เปลี่ยนไปหน้าถัดไปใน paginator                                              | มีข้อมูลมากกว่า 10 รายการ                                              | ตารางแสดงรายการตามหน้าที่เลือก และจำนวนรวม (totalRecords) ถูกต้อง                                           |
| TC-009        | เปลี่ยนจำนวนรายการต่อหน้า                 | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"<br>2. เปลี่ยน rows ต่อหน้าเป็น 25                                                 | มีข้อมูลอย่างน้อย 25 รายการ                                            | ตารางแสดง 25 รายการต่อหน้า และ paginator อัปเดตถูกต้อง                                                      |
| TC-010        | Multi-sort ในตาราง                        | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"<br>2. คลิกหัวคอลัมน์ "รหัสการตรวจ"<br>3. เพิ่ม sort คอลัมน์ "ประเภท" (Multi-sort) | มีข้อมูลอย่างน้อย 2 ค่าแตกต่างกันในคอลัมน์ที่ sort                     | ตารางเรียงลำดับตามเงื่อนไข multi-sort และส่งพารามิเตอร์ sort ไปที่ backend                                  |
| TC-011        | เลือกจังหวัดแล้วอำเภอ/ตำบลถูก enable      | 1. อยู่ Step 1<br>2. เลือก "จังหวัด"<br>3. ตรวจสอบ dropdown "อำเภอ/เขต" และ "ตำบล/แขวง"                                           | เลือกจังหวัดที่มีอำเภอ                                                 | "อำเภอ/เขต" ถูก enable และมีตัวเลือก; "ตำบล/แขวง" ยัง disabled จนกว่าจะเลือกอำเภอ                           |
| TC-012        | เลือกอำเภอแล้วตำบลถูก enable              | 1. อยู่ Step 1<br>2. เลือกจังหวัด<br>3. เลือกอำเภอ/เขต<br>4. ตรวจสอบ dropdown "ตำบล/แขวง"                                         | เลือกอำเภอที่มีตำบล                                                    | "ตำบล/แขวง" ถูก enable และมีตัวเลือกของอำเภอที่เลือก                                                        |
| TC-013        | กรองตามจังหวัด                            | 1. อยู่ Step 1<br>2. เลือกจังหวัด: สงขลา<br>3. กดปุ่ม "ค้นหา"                                                                     | เลือกจังหวัด: สงขลา                                                    | แสดงเฉพาะการตรวจในจังหวัดสงขลา                                                                              |
| TC-014        | กรองตามอำเภอ                              | 1. อยู่ Step 1<br>2. เลือกจังหวัด: สงขลา<br>3. เลือกอำเภอ: หาดใหญ่<br>4. กดปุ่ม "ค้นหา"                                           | เลือกจังหวัด: สงขลา, อำเภอ: หาดใหญ่                                    | แสดงเฉพาะการตรวจในอำเภอหาดใหญ่                                                                              |
| TC-015        | กรองตามตำบล                               | 1. อยู่ Step 1<br>2. เลือกจังหวัด/อำเภอ/ตำบล<br>3. กดปุ่ม "ค้นหา"                                                                 | เลือกจังหวัด: สงขลา, อำเภอ: หาดใหญ่, ตำบล: หาดใหญ่                     | แสดงเฉพาะการตรวจในตำบลหาดใหญ่                                                                               |
| TC-016        | ปุ่ม "ล้างค่า" รีเซ็ตตัวกรอง              | 1. เลือกจังหวัด/อำเภอ/ตำบล อย่างน้อย 1 ค่า<br>2. กดปุ่ม "ล้างค่า"                                                                 | มีการเลือกค่า filter ไว้                                               | ค่า จังหวัด/อำเภอ/ตำบล ถูกล้างทั้งหมด และรายการกลับสู่ผลลัพธ์เริ่มต้น                                       |
| TC-017        | ปุ่มแท็บ "อยู่ระหว่างการตรวจประเมิน"      | 1. อยู่ Step 1<br>2. กดปุ่ม "อยู่ระหว่างการตรวจประเมิน"                                                                           | มีรายการหลายสถานะ                                                      | ตารางแสดงรายการเฉพาะกลุ่ม "รอการตรวจประเมิน" และ "รอผลการตรวจประเมิน"                                       |
| TC-018        | ปุ่มแท็บ "ตรวจประเมินเสร็จแล้ว"           | 1. อยู่ Step 1<br>2. กดปุ่ม "ตรวจประเมินเสร็จแล้ว"                                                                                | มีรายการหลายสถานะ                                                      | ตารางแสดงรายการ "ตรวจประเมินแล้ว" และปุ่มแท็บถูกไฮไลต์                                                      |
| TC-019        | เลือกแถวแล้วปุ่ม "ถัดไป" ใช้งานได้        | 1. อยู่ Step 1<br>2. คลิกเลือกแถวหนึ่งในตาราง                                                                                     | มีอย่างน้อย 1 แถวในตาราง                                               | แถวที่เลือกถูก highlight (bg-green-50) และสามารถกดปุ่ม "ถัดไป" ได้                                          |
| TC-020        | กด "ถัดไป" โดยเลือกแถว                    | 1. อยู่ Step 1<br>2. เลือกแถว<br>3. กดปุ่ม "ถัดไป"                                                                                | เลือกแถวแล้ว                                                           | ไป Step 2 และโหลดข้อมูลการตรวจที่เลือก                                                                      |
| TC-021        | กด "ถัดไป" โดยไม่เลือกแถว                 | 1. อยู่ Step 1<br>2. ไม่เลือกแถว<br>3. กดปุ่ม "ถัดไป"                                                                             | ไม่เลือกแถว                                                            | ปุ่ม "ถัดไป" ถูก disabled                                                                                   |
| TC-022        | เปลี่ยนจังหวัดแล้วอำเภอ/ตำบลรีเซ็ต        | 1. อยู่ Step 1<br>2. เลือกจังหวัด/อำเภอ/ตำบล<br>3. เปลี่ยนจังหวัด                                                                 | มีการเลือกอำเภอและตำบลอยู่                                             | อำเภอและตำบลถูกรีเซ็ต                                                                                       |
| TC-023        | เปลี่ยนอำเภอแล้วตำบลรีเซ็ต                | 1. อยู่ Step 1<br>2. เลือกจังหวัด/อำเภอ/ตำบล<br>3. เปลี่ยนอำเภอ                                                                   | มีการเลือกตำบลอยู่                                                     | ตำบลถูกรีเซ็ต                                                                                               |
| TC-024        | แถวที่เลือกแสดง highlight                 | 1. อยู่ Step 1<br>2. คลิกเลือกแถว<br>3. ตรวจสอบ style ของแถว                                                                      | เลือกแถว inspectionId = 123                                            | แถวที่เลือกแสดง bg-green-50                                                                                 |
| TC-025        | เปลี่ยนแท็บแล้ว selectedInspection รีเซ็ต | 1. อยู่ Step 1<br>2. เลือกแถว<br>3. เปลี่ยนแท็บ                                                                                   | เลือกแถวแล้วเปลี่ยนแท็บ                                                | selectedInspection ถูกรีเซ็ตเป็น null                                                                       |

## Step 2: บันทึกการให้คำปรึกษาและข้อบกพร่อง

### วันที่บันทึกข้อมูล

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ           | ขั้นตอนการทดสอบ                                                                            | ข้อมูลการทดสอบ         | ค่าคาดหวัง                             |
| ------------- | -------------------------- | ------------------------------------------------------------------------------------------ | ---------------------- | -------------------------------------- |
| TC-026        | แสดงช่องวันที่บันทึกข้อมูล | 1. เลือกการตรวจ (Step 1)<br>2. กด "ถัดไป" ไป Step 2<br>3. ตรวจสอบช่อง "วันที่บันทึกข้อมูล" | ไม่มี                  | แสดงช่อง calendar "วันที่บันทึกข้อมูล" |
| TC-027        | เลือกวันที่บันทึกข้อมูล    | 1. ไป Step 2<br>2. เปิด calendar และเลือกวันที่: 01/01/2025<br>3. ตรวจสอบค่า               | เลือกวันที่ 01/01/2025 | วันที่บันทึกถูกบันทึก                  |
| TC-028        | วันที่เริ่มต้นเป็น null    | 1. เลือกการตรวจที่ไม่มี adviceAndDefect<br>2. ไป Step 2<br>3. ตรวจสอบค่า recordDate        | ไม่มี adviceAndDefect  | recordDate = null                      |

### รายการให้คำปรึกษา (Section 1)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                     | ขั้นตอนการทดสอบ                                                                  | ข้อมูลการทดสอบ               | ค่าคาดหวัง                                                              |
| ------------- | ------------------------------------ | -------------------------------------------------------------------------------- | ---------------------------- | ----------------------------------------------------------------------- |
| TC-029        | แสดงส่วน "รายการให้คำปรึกษา"         | 1. ไป Step 2<br>2. ตรวจสอบส่วน "1. รายการให้คำปรึกษา"                            | ไม่มี                        | แสดงส่วน "รายการให้คำปรึกษา" พร้อม 1 รายการเริ่มต้น                     |
| TC-030        | เพิ่มรายการให้คำปรึกษา               | 1. ไป Step 2<br>2. กด "เพิ่มรายการ" ในส่วนรายการให้คำปรึกษา                      | ไม่มี                        | เพิ่มรายการใหม่ (adviceItem, recommendation, time)                      |
| TC-031        | ลบรายการให้คำปรึกษา                  | 1. ไป Step 2<br>2. เพิ่มรายการให้มี 2 รายการ<br>3. กดปุ่ม "ลบรายการ"             | มี 2 รายการ                  | รายการที่เลือกถูกลบ และปุ่ม "ลบรายการ" แสดงเฉพาะเมื่อมีมากกว่า 1 รายการ |
| TC-032        | กรอกรายการให้คำปรึกษา                | 1. ไป Step 2<br>2. กรอก "รายการให้คำปรึกษา": "การใช้ปุ๋ย"<br>3. ตรวจสอบค่า       | กรอก "การใช้ปุ๋ย"            | ค่า adviceItem ถูกบันทึก                                                |
| TC-033        | กรอกแนวทางการแก้ไข                   | 1. ไป Step 2<br>2. กรอก "แนวทางการแก้ไข": "ใช้ปุ๋ยอินทรีย์"<br>3. ตรวจสอบค่า     | กรอก "ใช้ปุ๋ยอินทรีย์"       | ค่า recommendation ถูกบันทึก                                            |
| TC-034        | เลือกกำหนดระยะเวลา                   | 1. ไป Step 2<br>2. เปิด calendar และเลือกวันที่: 01/02/2025<br>3. ตรวจสอบค่า     | เลือกวันที่ 01/02/2025       | ค่า time ถูกบันทึก                                                      |
| TC-035        | กรอกข้อมูลครบถ้วน                    | 1. ไป Step 2<br>2. กรอก adviceItem, recommendation, time<br>3. กด "บันทึก"       | กรอกข้อมูลครบ                | ข้อมูลถูกส่งใน payload.adviceList                                       |
| TC-036        | มีรายการให้คำปรึกษาเริ่มต้น 1 รายการ | 1. เลือกการตรวจที่ไม่มี adviceAndDefect<br>2. ไป Step 2<br>3. ตรวจสอบ adviceList | ไม่มี adviceAndDefect        | adviceList มี 1 รายการว่าง                                              |
| TC-037        | ปุ่ม "ลบรายการ" ซ่อนเมื่อมี 1 รายการ | 1. ไป Step 2<br>2. ตรวจสอบปุ่ม "ลบรายการ"                                        | มีรายการให้คำปรึกษา 1 รายการ | ปุ่ม "ลบรายการ" ไม่แสดง                                                 |
| TC-038        | ปุ่ม "ลบรายการ" แสดงเมื่อมีมากกว่า 1 | 1. ไป Step 2<br>2. เพิ่มรายการให้มี 2 รายการ<br>3. ตรวจสอบปุ่ม "ลบรายการ"        | มี 2 รายการ                  | ปุ่ม "ลบรายการ" แสดงทุกรายการ                                           |

### ข้อบกพร่องที่พบ (Section 2)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                     | ขั้นตอนการทดสอบ                                                                   | ข้อมูลการทดสอบ              | ค่าคาดหวัง                                                              |
| ------------- | ------------------------------------ | --------------------------------------------------------------------------------- | --------------------------- | ----------------------------------------------------------------------- |
| TC-039        | แสดงส่วน "ข้อบกพร่องที่พบ"           | 1. ไป Step 2<br>2. ตรวจสอบส่วน "2. ข้อบกพร่องที่พบ"                               | ไม่มี                       | แสดงส่วน "ข้อบกพร่องที่พบ" พร้อม 1 รายการเริ่มต้น                       |
| TC-040        | เพิ่มรายการข้อบกพร่อง                | 1. ไป Step 2<br>2. กด "เพิ่มรายการ" ในส่วนข้อบกพร่อง                              | ไม่มี                       | เพิ่มรายการใหม่ (defectItem, defectDetail, time)                        |
| TC-041        | ลบรายการข้อบกพร่อง                   | 1. ไป Step 2<br>2. เพิ่มรายการให้มี 2 รายการ<br>3. กดปุ่ม "ลบรายการ"              | มี 2 รายการ                 | รายการที่เลือกถูกลบ และปุ่ม "ลบรายการ" แสดงเฉพาะเมื่อมีมากกว่า 1 รายการ |
| TC-042        | กรอกข้อบกพร่องที่พบ                  | 1. ไป Step 2<br>2. กรอก "ข้อบกพร่องที่พบ": "พื้นที่ไม่สะอาด"<br>3. ตรวจสอบค่า     | กรอก "พื้นที่ไม่สะอาด"      | ค่า defectItem ถูกบันทึก                                                |
| TC-043        | กรอกรายละเอียดข้อบกพร่อง             | 1. ไป Step 2<br>2. กรอก "รายละเอียดข้อบกพร่อง": "มีวัชพืชรอบสวน"<br>3. ตรวจสอบค่า | กรอก "มีวัชพืชรอบสวน"       | ค่า defectDetail ถูกบันทึก                                              |
| TC-044        | เลือกกำหนดระยะเวลาแก้ไข              | 1. ไป Step 2<br>2. เปิด calendar และเลือกวันที่: 01/03/2025<br>3. ตรวจสอบค่า      | เลือกวันที่ 01/03/2025      | ค่า time ถูกบันทึก                                                      |
| TC-045        | กรอกข้อมูลครบถ้วน                    | 1. ไป Step 2<br>2. กรอก defectItem, defectDetail, time<br>3. กด "บันทึก"          | กรอกข้อมูลครบ               | ข้อมูลถูกส่งใน payload.defectList                                       |
| TC-046        | มีรายการข้อบกพร่องเริ่มต้น 1 รายการ  | 1. เลือกการตรวจที่ไม่มี adviceAndDefect<br>2. ไป Step 2<br>3. ตรวจสอบ defectList  | ไม่มี adviceAndDefect       | defectList มี 1 รายการว่าง                                              |
| TC-047        | ปุ่ม "ลบรายการ" ซ่อนเมื่อมี 1 รายการ | 1. ไป Step 2<br>2. ตรวจสอบปุ่ม "ลบรายการ"                                         | มีรายการข้อบกพร่อง 1 รายการ | ปุ่ม "ลบรายการ" ไม่แสดง                                                 |
| TC-048        | ปุ่ม "ลบรายการ" แสดงเมื่อมีมากกว่า 1 | 1. ไป Step 2<br>2. เพิ่มรายการให้มี 2 รายการ<br>3. ตรวจสอบปุ่ม "ลบรายการ"         | มี 2 รายการ                 | ปุ่ม "ลบรายการ" แสดงทุกรายการ                                           |

## การบันทึกข้อมูล (Create/Update)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                     | ขั้นตอนการทดสอบ                                                                                      | ข้อมูลการทดสอบ                   | ค่าคาดหวัง                                                  |
| ------------- | ------------------------------------ | ---------------------------------------------------------------------------------------------------- | -------------------------------- | ----------------------------------------------------------- |
| TC-049        | สร้างข้อมูลใหม่ (Create)             | 1. เลือกการตรวจที่ไม่มี adviceAndDefect<br>2. ไป Step 2<br>3. กรอกข้อมูล<br>4. กด "บันทึก"           | ไม่มี adviceAndDefect            | เรียก POST API และแสดง toast "สร้างข้อมูลเรียบร้อย"         |
| TC-050        | แก้ไขข้อมูล (Update)                 | 1. เลือกการตรวจที่มี adviceAndDefect<br>2. ไป Step 2<br>3. แก้ไขข้อมูล<br>4. กด "บันทึก"             | มี adviceAndDefectId และ version | เรียก PUT API และแสดง toast "บันทึกข้อมูลเรียบร้อย"         |
| TC-051        | Update ส่ง version (Optimistic Lock) | 1. เลือกการตรวจที่มี adviceAndDefect<br>2. ไป Step 2<br>3. กด "บันทึก"<br>4. ตรวจสอบ payload         | version = 3                      | payload มี version สำหรับ optimistic locking                |
| TC-052        | Version conflict                     | 1. เปิด 2 หน้าต่าง<br>2. หน้า A บันทึกก่อน<br>3. หน้า B บันทึกด้วย version เดิม                      | version ไม่ตรง                   | แสดง toast error ตามข้อความจาก server                       |
| TC-053        | บันทึกไม่สำเร็จ (Network error)      | 1. ไป Step 2<br>2. ปิด network<br>3. กด "บันทึก"                                                     | จำลอง network error              | แสดง toast error "บันทึกข้อมูลไม่สำเร็จ"                    |
| TC-054        | ไม่มีการตรวจที่เลือก                 | 1. จำลอง Step 2 โดย selectedInspection = null<br>2. กด "บันทึก"                                      | selectedInspection = null        | แสดง toast error "ไม่มีการตรวจที่เลือก" และไม่เรียก API     |
| TC-055        | อัปเดต state หลัง Create             | 1. Create สำเร็จ<br>2. ตรวจสอบ state                                                                 | Create สำเร็จ                    | adviceAndDefectId และ version ถูกอัปเดต                     |
| TC-056        | อัปเดต state หลัง Update             | 1. Update สำเร็จ<br>2. ตรวจสอบ state                                                                 | Update สำเร็จ                    | version ถูกอัปเดตเป็นค่าล่าสุด                              |
| TC-057        | อัปเดต selectedInspection หลังบันทึก | 1. บันทึกสำเร็จ<br>2. ตรวจสอบ selectedInspection.adviceAndDefect                                     | บันทึกสำเร็จ                     | selectedInspection.adviceAndDefect ถูกอัปเดต                |
| TC-058        | buildPayload ถูกต้อง                 | 1. ไป Step 2<br>2. กรอกข้อมูลทุก section<br>3. ตรวจสอบ payload ก่อนส่ง                               | กรอกข้อมูลครบทุก section         | payload มี inspectionId, date, adviceList, defectList       |
| TC-059        | วันที่บันทึก default เป็นวันปัจจุบัน | 1. เลือกการตรวจที่ไม่มี adviceAndDefect<br>2. ไป Step 2<br>3. ไม่เลือกวันที่<br>4. กด "บันทึก"       | recordDate = null                | payload.date เป็นวันที่ปัจจุบัน (new Date())                |
| TC-060        | วันที่บันทึก ISO format              | 1. ไป Step 2<br>2. เลือกวันที่ 01/01/2025<br>3. กด "บันทึก"<br>4. ตรวจสอบ payload.date               | เลือกวันที่ 01/01/2025           | payload.date เป็น ISO string                                |
| TC-061        | time ใน adviceList ISO format        | 1. ไป Step 2<br>2. เลือก time: 01/02/2025 ในรายการคำปรึกษา<br>3. กด "บันทึก"<br>4. ตรวจสอบ payload   | เลือก time 01/02/2025            | payload.adviceList[0].time เป็น ISO string                  |
| TC-062        | time ใน defectList ISO format        | 1. ไป Step 2<br>2. เลือก time: 01/03/2025 ในรายการข้อบกพร่อง<br>3. กด "บันทึก"<br>4. ตรวจสอบ payload | เลือก time 01/03/2025            | payload.defectList[0].time เป็น ISO string                  |
| TC-063        | time เป็น null ถ้าไม่เลือก           | 1. ไป Step 2<br>2. ไม่เลือก time<br>3. กด "บันทึก"<br>4. ตรวจสอบ payload                             | ไม่เลือก time                    | payload.adviceList[0].time และ defectList[0].time เป็น null |

## การโหลดข้อมูลเดิม (Edit Mode)

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                      | ขั้นตอนการทดสอบ                                                          | ข้อมูลการทดสอบ                    | ค่าคาดหวัง                                                                   |
| ------------- | ------------------------------------- | ------------------------------------------------------------------------ | --------------------------------- | ---------------------------------------------------------------------------- |
| TC-064        | โหลดวันที่บันทึกข้อมูล                | 1. เลือกการตรวจที่มี adviceAndDefect.date<br>2. ไป Step 2                | adviceAndDefect.date มีค่า        | แสดงวันที่บันทึกในฟอร์ม                                                      |
| TC-065        | โหลดรายการให้คำปรึกษา                 | 1. เลือกการตรวจที่มี adviceAndDefect.adviceList<br>2. ไป Step 2          | adviceList มีข้อมูล               | แสดงรายการให้คำปรึกษาในฟอร์ม                                                 |
| TC-066        | โหลดรายการข้อบกพร่อง                  | 1. เลือกการตรวจที่มี adviceAndDefect.defectList<br>2. ไป Step 2          | defectList มีข้อมูล               | แสดงรายการข้อบกพร่องในฟอร์ม                                                  |
| TC-067        | โหลด adviceAndDefectId และ version    | 1. เลือกการตรวจที่มี adviceAndDefect<br>2. ไป Step 2<br>3. ตรวจสอบ state | adviceAndDefect มี id และ version | state เก็บ adviceAndDefectId และ version                                     |
| TC-068        | โหลดเมื่อ adviceList ว่าง             | 1. เลือกการตรวจที่ adviceList = []<br>2. ไป Step 2                       | adviceList = [] หรือไม่มี         | adviceList มี 1 รายการว่าง                                                   |
| TC-069        | โหลดเมื่อ defectList ว่าง             | 1. เลือกการตรวจที่ defectList = []<br>2. ไป Step 2                       | defectList = [] หรือไม่มี         | defectList มี 1 รายการว่าง                                                   |
| TC-070        | โหลด time จาก ISO string              | 1. เลือกการตรวจที่มี adviceList[0].time (ISO string)<br>2. ไป Step 2     | time = "2025-01-02T00:00:00Z"     | แสดงวันที่ในรูปแบบ Date object                                               |
| TC-071        | โหลดข้อมูลล้มเหลว (try-catch)         | 1. เลือกการตรวจที่ adviceAndDefect เสีย<br>2. ไป Step 2                  | adviceAndDefect โครงสร้างผิด      | แสดง console error และฟอร์มแสดงค่า default                                   |
| TC-072        | รีเซ็ตฟอร์มเมื่อไม่มี adviceAndDefect | 1. เลือกการตรวจที่ไม่มี adviceAndDefect<br>2. ไป Step 2                  | adviceAndDefect = null            | ฟอร์มแสดงค่า default (recordDate=null, 1 รายการคำปรึกษา, 1 รายการข้อบกพร่อง) |
| TC-073        | genId สร้าง id ไม่ซ้ำ                 | 1. ไป Step 2<br>2. เพิ่มรายการหลายครั้ง<br>3. ตรวจสอบ id ของแต่ละรายการ  | เพิ่มรายการหลายครั้ง              | แต่ละรายการมี id ไม่ซ้ำกัน                                                   |

## UI/UX และ Navigation

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                         | ขั้นตอนการทดสอบ                                                                  | ข้อมูลการทดสอบ            | ค่าคาดหวัง                                               |
| ------------- | ---------------------------------------- | -------------------------------------------------------------------------------- | ------------------------- | -------------------------------------------------------- |
| TC-074        | ปุ่ม "ย้อนกลับ" กลับไป Step 1            | 1. อยู่ Step 2<br>2. กดปุ่ม "ย้อนกลับ"                                           | ไม่มี                     | กลับไป Step 1 และยังคงเลือกการตรวจเดิม                   |
| TC-075        | ปุ่ม "บันทึก" disabled เมื่อไม่มีการตรวจ | 1. ไป Step 2 โดยไม่มี selectedInspection<br>2. ตรวจสอบปุ่ม "บันทึก"              | selectedInspection = null | ปุ่ม "บันทึก" ถูก disabled                               |
| TC-076        | แสดง StepIndicator ถูกต้อง               | 1. อยู่ Step 1<br>2. ตรวจสอบ StepIndicator<br>3. ไป Step 2<br>4. ตรวจสอบอีกครั้ง | ไม่มี                     | StepIndicator แสดง step ปัจจุบันถูกต้อง (1/2 และ 2/2)    |
| TC-077        | แสดงชื่อหน้าและคำอธิบาย                  | 1. เข้าหน้า "บันทึกการให้คำปรึกษาและข้อบกพร่อง"                                  | ไม่มี                     | แสดงชื่อ "บันทึกการให้คำปรึกษาและข้อบกพร่อง" และคำอธิบาย |
| TC-078        | Responsive layout                        | 1. เข้าหน้าจากหน้าจอขนาดต่างๆ                                                    | มือถือ/แท็บเล็ต/เดสก์ท็อป | Layout ปรับตามขนาดหน้าจอ (grid responsive)               |
| TC-079        | แสดง section headers ถูกต้อง             | 1. ไป Step 2<br>2. ตรวจสอบ headers                                               | ไม่มี                     | แสดง "1. รายการให้คำปรึกษา" และ "2. ข้อบกพร่องที่พบ"     |

## Edge Cases และ Integration

| รหัสกรณีทดสอบ | ชื่อกรณีการทดสอบ                     | ขั้นตอนการทดสอบ                                                               | ข้อมูลการทดสอบ                         | ค่าคาดหวัง                                                             |
| ------------- | ------------------------------------ | ----------------------------------------------------------------------------- | -------------------------------------- | ---------------------------------------------------------------------- |
| TC-080        | API timeout                          | 1. จำลอง API timeout<br>2. พยายามโหลดรายการหรือบันทึก                         | Network timeout                        | แสดง error message ไม่เกิด crash                                       |
| TC-081        | ไม่มี auditorId ใน session           | 1. Login โดยไม่มี roleData.auditorId<br>2. เข้าหน้า                           | auditorId = undefined                  | รายการว่างหรือแสดงทั้งหมด (ขึ้นกับ backend)                            |
| TC-082        | Refresh หลังบันทึกสำเร็จ             | 1. บันทึกข้อมูลสำเร็จ<br>2. ตรวจสอบว่ามีการเรียก fetchItems                   | บันทึกสำเร็จ                           | เรียก fetchItems เพื่อรีเฟรชรายการ                                     |
| TC-083        | คลิกแถวเพื่อเลือก                    | 1. อยู่ Step 1<br>2. คลิกที่แถว<br>3. ตรวจสอบ selectedInspection              | คลิกแถว inspectionId = 123             | selectedInspection.inspectionId = 123                                  |
| TC-084        | dataKey ใน DataTable                 | 1. อยู่ Step 1<br>2. ตรวจสอบ DataTable props                                  | ไม่มี                                  | dataKey = "inspectionId"                                               |
| TC-085        | rowClassName dynamic                 | 1. อยู่ Step 1<br>2. เลือกแถว<br>3. ตรวจสอบ class ของแถวที่เลือกและไม่เลือก   | เลือกแถว                               | แถวที่เลือกมี "bg-green-50 cursor-pointer", แถวอื่นมี "cursor-pointer" |
| TC-086        | ไม่มี roleData ใน session            | 1. Login โดย session ไม่มี user.roleData<br>2. เข้าหน้า                       | session.user.roleData = undefined      | ไม่ส่ง auditorId ไปที่ API (backend จัดการ)                            |
| TC-087        | API error message                    | 1. ไป Step 2<br>2. กด "บันทึก"<br>3. API ตอบกลับ error พร้อม message          | API error message = "Version conflict" | แสดง toast error "Version conflict"                                    |
| TC-088        | API error ไม่มี message              | 1. ไป Step 2<br>2. กด "บันทึก"<br>3. API ตอบกลับ error ไม่มี message          | API error ไม่มี message                | แสดง toast error "บันทึกข้อมูลไม่สำเร็จ"                               |
| TC-089        | Console error เมื่อโหลดข้อมูลล้มเหลว | 1. เลือกการตรวจที่ adviceAndDefect เสีย<br>2. ไป Step 2<br>3. ตรวจสอบ console | adviceAndDefect เสีย                   | แสดง console error "Failed to populate advice and defect to form"      |
| TC-090        | Console error เมื่อบันทึกล้มเหลว     | 1. ไป Step 2<br>2. กด "บันทึก"<br>3. API error<br>4. ตรวจสอบ console          | API error                              | แสดง console error "save advice and defect error"                      |
